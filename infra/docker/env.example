# ═══════════════════════════════════════════════════════════════════════════════
# AddressKit Docker Configuration
# ═══════════════════════════════════════════════════════════════════════════════
# Copy this file to .env and configure as needed.
# All values shown are defaults - uncomment and modify to customize.
#
# Quick Start:
#   1. cp env.example .env
#   2. Edit .env with your settings
#   3. docker compose up -d
#   4. docker compose --profile loader run --rm loader
# ═══════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────
# Image Configuration
# ─────────────────────────────────────────────────────────────────────────────

# AddressKit image (change for custom builds or private registries)
# ADDRESSKIT_IMAGE=bradleyhodges/addresskit
# ADDRESSKIT_VERSION=latest

# OpenSearch version (should match the version tested with AddressKit)
# OPENSEARCH_VERSION=1.3.20

# ─────────────────────────────────────────────────────────────────────────────
# G-NAF Data Loading Configuration
# ─────────────────────────────────────────────────────────────────────────────

# States to load (comma-separated)
# Options: ACT, NSW, VIC, QLD, SA, WA, TAS, NT
# Note: Loading all states requires significant disk space (~50GB) and time
# COVERED_STATES=ACT

# Enable geocoding (adds latitude/longitude to addresses)
# Increases index size by approximately 40%
# ADDRESSKIT_ENABLE_GEO=false

# Clear existing index before loading (use with caution!)
# ES_CLEAR_INDEX=false

# ─────────────────────────────────────────────────────────────────────────────
# OpenSearch Configuration
# ─────────────────────────────────────────────────────────────────────────────

# Index name for address data
# ES_INDEX_NAME=addresskit

# External port mappings
# OPENSEARCH_PORT=9200
# OPENSEARCH_TRANSPORT_PORT=9300

# JVM heap size (recommend 50% of container memory, max 32g)
# For production with 4GB+ RAM: 2g or higher
# OPENSEARCH_HEAP=1g

# Memory limits for OpenSearch container
# OPENSEARCH_MEMORY_LIMIT=2g
# OPENSEARCH_MEMORY_RESERVATION=1g

# OpenSearch authentication (if security plugin enabled)
# ELASTIC_USERNAME=
# ELASTIC_PASSWORD=

# ─────────────────────────────────────────────────────────────────────────────
# API Server Configuration
# ─────────────────────────────────────────────────────────────────────────────

# External API port
# API_PORT=7234

# Environment (production recommended for Docker)
# NODE_ENV=production

# CORS origin (set to your domain in production, e.g., https://example.com)
# Use * for development only
# CORS_ORIGIN=*

# API container resource limits
# API_MEMORY_LIMIT=512m
# API_MEMORY_RESERVATION=256m
# API_CPU_LIMIT=1.0
# API_CPU_RESERVATION=0.25

# Number of API replicas (requires Docker Swarm or --compatibility)
# API_REPLICAS=1

# ─────────────────────────────────────────────────────────────────────────────
# Caching Configuration
# ─────────────────────────────────────────────────────────────────────────────

# Enable response caching (recommended for production)
# CACHE_ENABLED=true

# Maximum number of cached entries
# CACHE_MAX_ENTRIES=1000

# Cache TTL in milliseconds (default: 5 minutes)
# CACHE_TTL_MS=300000

# ─────────────────────────────────────────────────────────────────────────────
# Loader Configuration
# ─────────────────────────────────────────────────────────────────────────────

# Loader container resource limits
# LOADER_MEMORY_LIMIT=2g
# LOADER_MEMORY_RESERVATION=512m

# Indexing retry configuration
# ADDRESSKIT_INDEX_TIMEOUT=300s
# ADDRESSKIT_INDEX_MAX_RETRIES=10

# ─────────────────────────────────────────────────────────────────────────────
# Download Configuration (for G-NAF data download reliability)
# ─────────────────────────────────────────────────────────────────────────────
# These settings help handle network instability when downloading G-NAF data
# from data.gov.au, which is especially important in containerized environments.

# Maximum retry attempts for failed downloads (default: 5)
# Set higher for unreliable networks
# ADDRESSKIT_DOWNLOAD_MAX_RETRIES=5

# Initial backoff delay in ms before first retry (default: 5000 = 5 seconds)
# ADDRESSKIT_DOWNLOAD_BACKOFF_INITIAL=5000

# Maximum backoff delay in ms between retries (default: 60000 = 1 minute)
# ADDRESSKIT_DOWNLOAD_BACKOFF_MAX=60000

# Socket timeout in ms - connection reset if no data received (default: 30000)
# Increase if on slow/unreliable networks
# ADDRESSKIT_DOWNLOAD_SOCKET_TIMEOUT=30000

# Connection timeout in ms - time to establish connection (default: 30000)
# ADDRESSKIT_DOWNLOAD_CONNECT_TIMEOUT=30000

# ─────────────────────────────────────────────────────────────────────────────
# G-NAF Mirror Configuration
# ─────────────────────────────────────────────────────────────────────────────
# AddressKit includes a CDN-powered mirror for faster, more reliable G-NAF downloads.
# The mirror is hosted at dl.addresskit.com.au and is used by default.

# Whether to use the AddressKit mirror (default: true)
# Set to false to download directly from data.gov.au
# GNAF_USE_MIRROR=true

# Custom mirror URL (if you're hosting your own mirror)
# GNAF_MIRROR_URL=https://dl.addresskit.com.au/package_show.conf.json

# ─────────────────────────────────────────────────────────────────────────────
# Monitoring Configuration (optional profile)
# ─────────────────────────────────────────────────────────────────────────────

# OpenSearch Dashboards port
# DASHBOARDS_PORT=5601

# Dashboards memory limit
# DASHBOARDS_MEMORY_LIMIT=512m

# ─────────────────────────────────────────────────────────────────────────────
# Logging & Debugging
# ─────────────────────────────────────────────────────────────────────────────

# Enable verbose logging
# VERBOSE=false

# Debug namespaces (comma-separated: api,error,loader,es)
# DEBUG=api,error

# ─────────────────────────────────────────────────────────────────────────────
# Production Recommendations
# ─────────────────────────────────────────────────────────────────────────────
# 
# For a production deployment, consider:
#
# 1. SECURITY:
#    - Set CORS_ORIGIN to your specific domain(s)
#    - Enable OpenSearch security plugin (remove plugins.security.disabled=true)
#    - Set ELASTIC_USERNAME and ELASTIC_PASSWORD
#    - Use HTTPS (configure reverse proxy like nginx/traefik)
#
# 2. PERFORMANCE:
#    - Increase OPENSEARCH_HEAP based on available RAM
#    - Adjust resource limits based on expected traffic
#    - Consider multiple API_REPLICAS behind a load balancer
#    - Enable CACHE_ENABLED=true with appropriate TTL
#
# 3. RELIABILITY:
#    - Set up volume backups for opensearch-data and gnaf-data
#    - Configure log aggregation (e.g., to ELK, Loki, CloudWatch)
#    - Set up monitoring and alerting
#    - Use external OpenSearch cluster for high availability
#
# 4. RESOURCES (minimum recommendations):
#    - Small (1 state):  2GB RAM, 10GB disk
#    - Medium (3 states): 4GB RAM, 30GB disk
#    - Large (all states): 8GB+ RAM, 100GB+ disk
# ═══════════════════════════════════════════════════════════════════════════════

